{% assign titleTag = tag | default: "h2" %}
{% assign inPostMode = in-post | default: in_post | default: false %}
{% assign cardRootTag = "article" %}
{% assign cardRootClass = "post-card" %}
{% assign titleItemprop = "" %}

{% if inPostMode %}
  {% assign cardRootTag = "header" %}
  {% assign cardRootClass = "post-card post-card_in-post" %}
  {% assign titleItemprop = ' itemprop="name headline"' %}
{% endif %}

<{{ cardRootTag }} class="{{ cardRootClass }}">
{% if link %}<a href="{{ link }}" class="post-card__link">{% endif %}
  <{{ titleTag }} class="post-card__title"{{ titleItemprop }}>
  {{ title }}
  <hr class="post-card__divider">
</{{ titleTag }}>
  {% if link %}</a>{% endif %}

{% if date or tags %}
  <div class="post-card__meta">
      {% if date %}
        <span class="post-card__date">{% include "pubdate.liquid", date: date %}</span>
      {% endif %}

    {% if date and tags %}:::{% endif %}

    {% if tags %}
      <span class="post-card__tags">
        {% for itemTag in tags %}
          {% assign tagTrimmed = itemTag | strip %}
          {% assign tagSlug = tagTrimmed | tagSlug %}
          {% assign tagUrl = "/tag/" | append: tagSlug | append: "/" %}
          {% assign tagLabel = tagTrimmed | tagLabel %}
          <a href="{{ tagUrl }}">{{ tagLabel }}</a>{% unless forloop.last %}, {% endunless %}
        {% endfor %}
        </span>
    {% endif %}
    </div>
{% endif %}

{% if imagePath and inPostMode != true %}
  <div class="post-card__cover">
        {% if link %}<a href="{{ link }}">{% endif %}
            {% assign cardImageAlt = imageAlt | default: title %}
            {% mediaImage imagePath, cardImageAlt %}
            {% if link %}</a>{% endif %}
    </div>
{% endif %}

{% if description and inPostMode != true %}
  <div class="post-card__content">
      <p>{{ description }}</p>
    </div>
{% endif %}
</{{ cardRootTag }}>

{% css %}
{% include "styles/post-card.css" %}
{% endcss %}
