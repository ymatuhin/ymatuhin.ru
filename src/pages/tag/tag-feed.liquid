---
pagination:
  data: collections.tagPages
  size: 1
  alias: currentTagPage
permalink: "/tag/{{ currentTagPage.slug }}/feed.xml"
eleventyExcludeFromCollections: true
---
<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>{{ site.title | escape }} — {{ currentTagPage.name | escape }}</title>
    <link>{{ site.url }}/tag/{{ currentTagPage.slug }}/</link>
    <description>Публикации с тегом {{ currentTagPage.name | escape }}</description>
    <language>{{ site.lang | default: "ru" }}</language>
    <atom:link href="{{ site.url }}/tag/{{ currentTagPage.slug }}/feed.xml" rel="self" type="application/rss+xml" />
    {%- for post in collections.posts -%}
      {% assign showPost = false %}
      {% assign currentTagKey = currentTagPage.key %}
      {% for postTag in post.data.tags %}
        {% assign postTagNormalized = postTag | tagSlug %}
        {% if postTagNormalized == currentTagKey %}
          {% assign showPost = true %}
        {% endif %}
      {% endfor %}
      {% if showPost %}
        <item>
          <title>{{ post.data.title | default: post.fileSlug | escape }}</title>
          <link>{{ site.url }}{{ post.url }}</link>
          <guid isPermaLink="true">{{ site.url }}{{ post.url }}</guid>
          <pubDate>{{ post.date | date_to_rfc822 }}</pubDate>
          {% if post.data.description %}
            <description>{{ post.data.description | escape }}</description>
          {% endif %}
        </item>
      {% endif %}
    {%- endfor -%}
  </channel>
</rss>
